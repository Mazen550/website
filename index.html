<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Valentine's Day</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #000;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <canvas id="starfield"></canvas>
    <script>
        var canvas = document.getElementById("starfield");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        var context = canvas.getContext("2d");

        // STARFIELD
        var stars = 800;
        var colorrange = [0, 60, 240];
        var starArray = [];

        function getRandom(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // Initialize background stars
        for (var i = 0; i < stars; i++) {
            starArray.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                radius: Math.random() * 1.5,
                hue: colorrange[getRandom(0, colorrange.length - 1)],
                sat: getRandom(50, 100),
                opacity: Math.random()
            });
        }

        // TEXT TIMING
        var frameNumber = 0;
        var opacity = 0;
        var secondOpacity = 0;
        var thirdOpacity = 0;

        // 3D HEART
        var heartParticles = [];
        var heartCount = 3000;
        var heartAngle = 0;
        var heartVisible = false;

        // Smaller 3D heart shape
        function heartShape(t, layer) {
            var scale = 7; // smaller heart
            return {
                x: scale * 16 * Math.pow(Math.sin(t), 3),
                y: -scale * (13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t)),
                z: layer
            };
        }

        function createHeart() {
            heartParticles = [];
            var layers = 30;
            var particlesPerLayer = Math.floor(heartCount / layers);

            for (let layer = 0; layer < layers; layer++) {
                let zDepth = (layer / layers - 0.5) * 150;

                for (let i = 0; i < particlesPerLayer; i++) {
                    let t = (i / particlesPerLayer) * Math.PI * 2;
                    let pos = heartShape(t, zDepth);
                    let randomScale = Math.random();

                    heartParticles.push({
                        currentX: (Math.random() - 0.5) * canvas.width * 2,
                        currentY: (Math.random() - 0.5) * canvas.height * 2,
                        currentZ: (Math.random() - 0.5) * 1000,
                        targetX: pos.x * randomScale,
                        targetY: pos.y * randomScale,
                        targetZ: pos.z + (Math.random() - 0.5) * 20
                    });
                }
            }
        }

        createHeart();

        function drawStars() {
            for (var star of starArray) {
                context.beginPath();
                context.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                context.fillStyle = "hsla(" + star.hue + "," + star.sat + "%,88%," + star.opacity + ")";
                context.fill();

                if (Math.random() > 0.99) {
                    star.opacity = Math.random();
                }
            }
        }

        function drawHeart() {
            heartAngle += 0.008;
            let cos = Math.cos(heartAngle);
            let sin = Math.sin(heartAngle);

            let sortedParticles = heartParticles.slice().sort((a, b) => {
                let za = a.targetX * sin + a.targetZ * cos;
                let zb = b.targetX * sin + b.targetZ * cos;
                return za - zb;
            });

            for (let p of sortedParticles) {
                p.currentX += (p.targetX - p.currentX) * 0.03;
                p.currentY += (p.targetY - p.currentY) * 0.03;
                p.currentZ += (p.targetZ - p.currentZ) * 0.03;

                let x = p.currentX * cos - p.currentZ * sin;
                let z = p.currentX * sin + p.currentZ * cos;
                let scale = 250 / (250 + z);

                let px = x * scale + canvas.width / 2;
                let py = p.currentY * scale + canvas.height / 2;

                let size = scale * 1.8; // smaller particles
                let brightness = Math.max(0.3, Math.min(1, scale));
                context.fillStyle = "rgba(255, 150, 200," + (brightness * 0.8) + ")";
                context.fillRect(px, py, size, size);
            }
        }

        function drawTextWithLineBreaks(lines, x, y, fontSize, lineHeight) {
            lines.forEach((line, index) => {
                context.fillText(line, x, y + index * (fontSize + lineHeight));
            });
        }

        function drawText() {
            var fontSize = Math.min(24, canvas.width / 18); // smaller for phones
            var lineHeight = 6;
            context.font = fontSize + "px Comic Sans MS";
            context.textAlign = "center";
            context.shadowColor = "rgba(255,100,200,1)";
            context.shadowBlur = 10;

            // Example: first text block
            if(frameNumber < 300){
                if (canvas.width < 400){
                    drawTextWithLineBreaks(["everyday day I cannot believe", "how lucky I am"], canvas.width/2, canvas.height/2, fontSize, lineHeight);
                } else {
                    context.fillText("everyday day I cannot believe how lucky I am", canvas.width/2, canvas.height/2);
                }
                opacity += 0.0067;
            }
            if(frameNumber >= 300 && frameNumber < 600){
                if (canvas.width < 400){
                    drawTextWithLineBreaks(["everyday day I cannot believe", "how lucky I am"], canvas.width/2, canvas.height/2, fontSize, lineHeight);
                } else {
                    context.fillText("everyday day I cannot believe how lucky I am", canvas.width/2, canvas.height/2);
                }
            }
            if(frameNumber >= 600 && frameNumber < 900){
                if (canvas.width < 400){
                    drawTextWithLineBreaks(["everyday day I cannot believe", "how lucky I am"], canvas.width/2, canvas.height/2, fontSize, lineHeight);
                } else {
                    context.fillText("everyday day I cannot believe how lucky I am", canvas.width/2, canvas.height/2);
                }
                opacity -= 0.0067;
            }
            if(frameNumber == 900) opacity = 0;

            // You can continue this same method for all other text blocks,
            // using drawTextWithLineBreaks for small screens.
            
            context.shadowBlur = 0;
        }

        function draw() {
            context.fillStyle = "rgba(0,0,0,0.25)";
            context.fillRect(0, 0, canvas.width, canvas.height);

            drawStars();
            drawText();

            if(heartVisible){
                drawHeart();
            }

            frameNumber++;
            requestAnimationFrame(draw);
        }

        draw();

        window.addEventListener("resize", function(){
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>